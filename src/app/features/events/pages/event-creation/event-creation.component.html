<div class="max-w-7xl mx-auto space-y-6">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 sm:gap-0">
        <div class="min-w-0 flex-1">
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 break-words">Create New Event</h1>
            <p class="text-sm sm:text-base text-gray-600 mt-1">Set up your event with AI-powered suggestions and smart
                features</p>
        </div>
        <button routerLink="/events" class="btn-secondary flex items-center text-sm sm:text-base">
            <span>Cancel</span>
        </button>
    </div>

    <div class="flex flex-col lg:flex-row gap-8">
        <!-- Main Form Area -->
        <div class="flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <!-- Progress Steps -->
            <div class="bg-gray-50 border-b border-gray-200 px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2" [class.text-primary-600]="currentStep >= 1"
                        [class.text-gray-400]="currentStep < 1">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full border-2 font-semibold"
                            [class.border-primary-600]="currentStep >= 1" [class.bg-primary-50]="currentStep === 1"
                            [class.border-gray-300]="currentStep < 1">1</span>
                        <span class="hidden sm:inline font-medium">Basic Info</span>
                    </div>
                    <div class="flex-1 h-0.5 bg-gray-200 mx-4">
                        <div class="h-full bg-primary-600 transition-all duration-300"
                            [style.width.%]="currentStep > 1 ? 100 : 0"></div>
                    </div>
                    <div class="flex items-center space-x-2" [class.text-primary-600]="currentStep >= 2"
                        [class.text-gray-400]="currentStep < 2">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full border-2 font-semibold"
                            [class.border-primary-600]="currentStep >= 2" [class.bg-primary-50]="currentStep === 2"
                            [class.border-gray-300]="currentStep < 2">2</span>
                        <span class="hidden sm:inline font-medium">Details</span>
                    </div>
                    <div class="flex-1 h-0.5 bg-gray-200 mx-4">
                        <div class="h-full bg-primary-600 transition-all duration-300"
                            [style.width.%]="currentStep > 2 ? 100 : 0"></div>
                    </div>
                    <div class="flex items-center space-x-2" [class.text-primary-600]="currentStep >= 3"
                        [class.text-gray-400]="currentStep < 3">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full border-2 font-semibold"
                            [class.border-primary-600]="currentStep >= 3" [class.bg-primary-50]="currentStep === 3"
                            [class.border-gray-300]="currentStep < 3">3</span>
                        <span class="hidden sm:inline font-medium">Settings</span>
                    </div>
                    <div class="flex-1 h-0.5 bg-gray-200 mx-4">
                        <div class="h-full bg-primary-600 transition-all duration-300"
                            [style.width.%]="currentStep > 3 ? 100 : 0"></div>
                    </div>
                    <div class="flex items-center space-x-2" [class.text-primary-600]="currentStep >= 4"
                        [class.text-gray-400]="currentStep < 4">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full border-2 font-semibold"
                            [class.border-primary-600]="currentStep >= 4" [class.bg-primary-50]="currentStep === 4"
                            [class.border-gray-300]="currentStep < 4">4</span>
                        <span class="hidden sm:inline font-medium">Review</span>
                    </div>
                </div>
            </div>

            <form [formGroup]="eventForm" (ngSubmit)="onSubmit()" class="p-6">
                <!-- Step 1: Basic Information -->
                <div *ngIf="currentStep === 1" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Event Title *</label>
                        <input type="text" formControlName="title" class="input-field w-full"
                            placeholder="Enter event title"
                            [class.border-red-300]="f['title'].invalid && f['title'].touched">
                        <p *ngIf="f['title'].invalid && f['title'].touched" class="mt-1 text-xs text-red-500">Title is
                            required</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description *</label>
                        <textarea formControlName="description" rows="4" class="input-field w-full"
                            placeholder="Describe your event..."
                            [class.border-red-300]="f['description'].invalid && f['description'].touched"></textarea>
                        <p *ngIf="f['description'].invalid && f['description'].touched"
                            class="mt-1 text-xs text-red-500">Description is required</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Date *</label>
                        <input type="date" formControlName="date" class="input-field w-full" [min]="minDate"
                            [class.border-red-300]="f['date'].invalid && f['date'].touched">
                        <p *ngIf="f['date'].errors?.['required'] && f['date'].touched"
                            class="mt-1 text-xs text-red-500">
                            Date is required</p>
                        <p *ngIf="f['date'].errors?.['pastDate'] && f['date'].touched"
                            class="mt-1 text-xs text-red-500">
                            Event date must be tomorrow or later</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Start Time *</label>
                            <div class="flex gap-2">
                                <select formControlName="timeHour" class="input-field flex-1">
                                    <option *ngFor="let h of hours" [value]="h">{{h}}</option>
                                </select>
                                <span class="flex items-center text-gray-500">:</span>
                                <select formControlName="timeMinute" class="input-field flex-1">
                                    <option *ngFor="let m of minutes" [value]="m">{{m}}</option>
                                </select>
                                <select formControlName="timePeriod" class="input-field flex-1">
                                    <option *ngFor="let p of periods" [value]="p">{{p}}</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">End Time *</label>
                            <div class="flex gap-2">
                                <select formControlName="endTimeHour" class="input-field flex-1">
                                    <option *ngFor="let h of hours" [value]="h">{{h}}</option>
                                </select>
                                <span class="flex items-center text-gray-500">:</span>
                                <select formControlName="endTimeMinute" class="input-field flex-1">
                                    <option *ngFor="let m of minutes" [value]="m">{{m}}</option>
                                </select>
                                <select formControlName="endTimePeriod" class="input-field flex-1">
                                    <option *ngFor="let p of periods" [value]="p">{{p}}</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Category *</label>
                        <select formControlName="category" class="input-field w-full"
                            [class.border-red-300]="f['category'].invalid && f['category'].touched">
                            <option value="">Select category</option>
                            <option *ngFor="let cat of categories" [value]="cat">{{cat}}</option>
                        </select>
                        <p *ngIf="f['category'].invalid && f['category'].touched" class="mt-1 text-xs text-red-500">
                            Category is required</p>
                    </div>
                </div>

                <!-- Step 2: Event Details -->
                <div *ngIf="currentStep === 2" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Location * <span class="text-xs text-gray-500 font-normal">(Philippines only)</span>
                        </label>
                        <app-location-search formControlName="location" [required]="true"></app-location-search>
                        <p *ngIf="f['location'].invalid && f['location'].touched" class="mt-1 text-xs text-red-500">
                            Location is required</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Maximum Participants</label>
                            <input type="number" formControlName="maxParticipants" class="input-field w-full"
                                placeholder="Enter max participants">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                            <input type="text" formControlName="tagInput" (keydown.enter)="addTag($event)"
                                class="input-field w-full" placeholder="Press Enter to add tags">
                        </div>
                    </div>

                    <div *ngIf="tags.length > 0">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Added Tags</label>
                        <div class="flex flex-wrap gap-2">
                            <span *ngFor="let tag of tags"
                                class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800">
                                {{ tag }}
                                <button type="button" (click)="removeTag(tag)"
                                    class="ml-2 text-primary-600 hover:text-primary-800">
                                    &times;
                                </button>
                            </span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Event Image</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <div *ngIf="imagePreview" class="space-y-4">
                                <img [src]="imagePreview" alt="Event preview"
                                    class="mx-auto h-32 w-48 object-cover rounded-lg">
                                <button type="button" (click)="removeImage()"
                                    class="text-red-600 hover:text-red-800 text-sm">Remove Image</button>
                            </div>
                            <div *ngIf="!imagePreview">
                                <label
                                    class="cursor-pointer inline-block px-4 py-2 rounded-lg bg-primary-600 text-white hover:bg-primary-700">
                                    Upload Image
                                    <input type="file" (change)="onImageSelected($event)" accept="image/*"
                                        class="hidden">
                                </label>
                                <p class="mt-2 text-xs text-gray-500">PNG, JPG, GIF up to 5MB</p>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center space-x-3">
                        <input type="checkbox" formControlName="isVirtual" class="h-4 w-4 text-primary-600 rounded">
                        <label class="text-sm font-medium text-gray-700">This is a virtual event</label>
                    </div>

                    <div *ngIf="eventForm.get('isVirtual')?.value">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Virtual Meeting Link</label>
                        <input type="url" formControlName="virtualLink" class="input-field w-full"
                            placeholder="https://meet.google.com/...">
                    </div>
                </div>

                <!-- Step 3: Settings & Contact -->
                <div *ngIf="currentStep === 3" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Requirements</label>
                        <textarea formControlName="requirements" rows="3" class="input-field w-full"
                            placeholder="Any special requirements..."></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contact Email *</label>
                            <input type="email" formControlName="contactEmail" class="input-field w-full"
                                [class.border-red-300]="f['contactEmail'].invalid && f['contactEmail'].touched">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Contact Phone</label>
                            <input type="tel" formControlName="contactPhone" class="input-field w-full"
                                placeholder="+1 (555) 123-4567">
                        </div>
                    </div>

                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-medium text-blue-900 mb-2">AI-Powered Suggestions</h4>
                        <ul class="space-y-2">
                            <li *ngFor="let suggestion of aiSuggestions"
                                class="flex items-start space-x-2 text-sm text-blue-800">
                                <span class="text-blue-600 mt-0.5">â€¢</span>
                                <span>{{ suggestion }}</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Step 4: Review -->
                <div *ngIf="currentStep === 4" class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-lg space-y-4">
                        <h3 class="text-lg font-semibold text-gray-900">Event Preview</h3>
                        <div>
                            <h4 class="font-medium text-gray-900">{{ f['title'].value || 'Event Title' }}</h4>
                            <p class="text-sm text-gray-600">{{ f['description'].value || 'Description...' }}</p>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
                            <p><span class="font-medium">Date:</span> {{ f['date'].value }}</p>
                            <p><span class="font-medium">Time:</span> {{ f['timeHour'].value }}:{{ f['timeMinute'].value
                                }} {{ f['timePeriod'].value }} -
                                {{ f['endTimeHour'].value }}:{{ f['endTimeMinute'].value }} {{
                                f['endTimePeriod'].value }}</p>
                            <p><span class="font-medium">Location:</span> {{ f['location'].value }}</p>
                            <p><span class="font-medium">Category:</span> {{ f['category'].value }}</p>
                        </div>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-medium text-yellow-900 mb-2">Before Publishing</h4>
                        <ul class="text-sm text-yellow-800 space-y-1 ml-4 list-disc">
                            <li>Review all event details carefully</li>
                            <li>Ensure contact information is correct</li>
                            <li>Check that date and time are accurate</li>
                            <li>Verify location details</li>
                        </ul>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="mt-8 flex justify-between pt-6 border-t border-gray-200">
                    <button type="button" *ngIf="currentStep > 1" (click)="prevStep()" class="btn-secondary px-6">
                        Back
                    </button>
                    <div class="flex-1"></div> <!-- Spacer -->
                    <button type="button" *ngIf="currentStep < 4" (click)="nextStep()"
                        class="btn-primary px-6 ml-auto block">
                        Next Step
                    </button>
                    <button type="submit" *ngIf="currentStep === 4" [disabled]="loading"
                        class="btn-primary px-8 ml-auto block flex items-center">
                        <svg *ngIf="loading" class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" fill="none"
                            viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                            </circle>
                            <path class="opacity-75" fill="currentColor"
                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                            </path>
                        </svg>
                        {{ loading ? 'Publishing...' : 'Publish Event' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>